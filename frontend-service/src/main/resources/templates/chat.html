<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chat - Freelance Market</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 font-sans h-screen flex flex-col">

<nav class="bg-white shadow-md flex-none">
    <div class="container mx-auto px-6 py-4 flex justify-between items-center">
        <a href="/" class="text-2xl font-bold text-blue-600 hover:text-blue-800">FreelanceMarket</a>
        <a href="/gigs" class="text-gray-600 hover:text-blue-600 font-medium">Back to Gigs</a>
    </div>
</nav>

<div class="flex-grow container mx-auto px-4 py-6 flex flex-col max-w-4xl">

    <div class="bg-white p-4 rounded-t-xl shadow-sm border-b border-gray-200 flex justify-between items-center">
        <h2 class="text-lg font-bold text-gray-800">Conversation with User #{otherUserId}</h2>
        <span class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded">ID: {otherUserId}</span>
    </div>

    <div class="flex-grow bg-white p-6 overflow-y-auto shadow-sm space-y-4" id="messageContainer">
        {#for msg in messages}
        {#if msg.senderId == myId}
        <div class="flex justify-end">
            <div class="bg-blue-600 text-white px-4 py-2 rounded-l-lg rounded-tr-lg max-w-md shadow-md">
                <p>{msg.content}</p>
                <span class="text-xs text-blue-200 block text-right mt-1">{msg.sentAt}</span>
            </div>
        </div>
        {#else}
        <div class="flex justify-start">
            <div class="bg-gray-200 text-gray-800 px-4 py-2 rounded-r-lg rounded-tl-lg max-w-md shadow-sm">
                <p>{msg.content}</p>
                <span class="text-xs text-gray-500 block mt-1">{msg.sentAt}</span>
            </div>
        </div>
        {/if}
        {/for}

        {#if messages.isEmpty}
        <div class="text-center text-gray-400 mt-10">
            <p>No messages yet. Say hello! ðŸ‘‹</p>
        </div>
        {/if}
    </div>

    <div class="bg-white p-4 rounded-b-xl shadow-sm border-t border-gray-200">
        <form action="/chat/send/{otherUserId}" method="POST" class="flex gap-4">
            <input type="text" name="content" placeholder="Type a message..." required
                   class="flex-grow border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
            <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold px-6 py-3 rounded-lg transition flex items-center gap-2">
                Send
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" /></svg>
            </button>
        </form>
    </div>
</div>

<script>
    const container = document.getElementById('messageContainer');
    container.scrollTop = container.scrollHeight;
</script>

</body>
</html>